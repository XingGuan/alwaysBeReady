<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Vue3 H5 åˆ®åˆ®ä¹æ’ä»¶</title>
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', 'Microsoft YaHei', sans-serif;
        }

        body {
            background: linear-gradient(135deg, #6a11cb 0%, #2575fc 100%);
            min-height: 100vh;
            padding: 20px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
        }

        .container {
            max-width: 900px;
            width: 100%;
            background-color: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 15px 35px rgba(0, 0, 0, 0.2);
            margin-bottom: 30px;
        }

        h1 {
            text-align: center;
            color: #2c3e50;
            margin-bottom: 10px;
            font-size: 2.5rem;
            background: linear-gradient(90deg, #ff6b6b, #4ecdc4);
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }

        .subtitle {
            text-align: center;
            color: #7f8c8d;
            margin-bottom: 40px;
            font-size: 1.1rem;
        }

        .scratch-demo-area {
            display: flex;
            flex-wrap: wrap;
            gap: 25px;
            justify-content: center;
            margin-bottom: 40px;
        }

        .card-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            background: #f8f9fa;
            padding: 20px;
            border-radius: 15px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.08);
            transition: transform 0.3s, box-shadow 0.3s;
        }

        .card-container:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.12);
        }

        .card-title {
            margin-bottom: 15px;
            color: #34495e;
            font-weight: 600;
            font-size: 1.2rem;
        }

        .scratch-container {
            position: relative;
            display: inline-block;
            user-select: none;
            -webkit-tap-highlight-color: transparent;
            border-radius: 12px;
            overflow: hidden;
        }

        .prize-content {
            position: absolute;
            top: 0;
            left: 0;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            text-align: center;
            border-radius: 12px;
            overflow: hidden;
        }

        .default-prize {
            padding: 20px;
            width: 100%;
            height: 100%;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
        }

        .prize-main {
            font-size: 26px;
            font-weight: bold;
            margin-bottom: 8px;
        }

        .prize-desc {
            font-size: 14px;
            color: #666;
        }

        .scratch-canvas {
            position: relative;
            z-index: 1;
            cursor: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 32 32"><circle cx="16" cy="16" r="14" fill="none" stroke="%23000" stroke-width="1"/></svg>') 16 16, auto;
            touch-action: none;
            border-radius: 12px;
            background: transparent;
        }

        .percentage {
            margin-top: 12px;
            text-align: center;
            font-size: 14px;
            color: #666;
            font-weight: 500;
        }

        .controls {
            background: #f8f9fa;
            padding: 25px;
            border-radius: 15px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.05);
            margin-bottom: 30px;
        }

        .controls h2 {
            color: #2c3e50;
            margin-bottom: 20px;
            text-align: center;
            font-size: 1.5rem;
        }

        .button-group {
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
            justify-content: center;
            margin-bottom: 20px;
        }

        button {
            padding: 12px 24px;
            border: none;
            border-radius: 8px;
            background: linear-gradient(135deg, #4ecdc4, #44a08d);
            color: white;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            font-size: 16px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }

        button:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 12px rgba(0, 0, 0, 0.15);
        }

        button:active {
            transform: translateY(0);
        }

        .btn-reset {
            background: linear-gradient(135deg, #ff6b6b, #ee5a52);
        }

        .btn-check {
            background: linear-gradient(135deg, #48cae4, #0096c7);
        }

        .btn-info {
            background: linear-gradient(135deg, #ffd166, #f9c74f);
        }

        .result-area {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 15px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.05);
        }

        .result-area h2 {
            color: #2c3e50;
            margin-bottom: 15px;
            text-align: center;
            font-size: 1.5rem;
        }

        .result-list {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            gap: 15px;
        }

        .result-item {
            background: white;
            padding: 15px;
            border-radius: 10px;
            box-shadow: 0 3px 8px rgba(0, 0, 0, 0.05);
        }

        .result-title {
            font-weight: 600;
            color: #2c3e50;
            margin-bottom: 5px;
        }

        .result-value {
            color: #4ecdc4;
            font-weight: 600;
            font-size: 1.2rem;
        }

        .instructions {
            margin-top: 30px;
            background: #f8f9fa;
            padding: 25px;
            border-radius: 15px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.05);
        }

        .instructions h2 {
            color: #2c3e50;
            margin-bottom: 15px;
            text-align: center;
            font-size: 1.5rem;
        }

        .instructions p {
            margin-bottom: 10px;
            color: #555;
            line-height: 1.6;
        }

        .instructions ul {
            padding-left: 20px;
            color: #555;
            line-height: 1.6;
        }

        .instructions li {
            margin-bottom: 8px;
        }

        .footer {
            text-align: center;
            color: rgba(255, 255, 255, 0.8);
            margin-top: 20px;
            font-size: 0.9rem;
        }

        .custom-prize {
            padding: 15px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            width: 100%;
            height: 100%;
        }

        .prize-icon {
            font-size: 40px;
            display: block;
            margin-bottom: 10px;
        }

        .prize-emoji {
            font-size: 50px;
            margin-bottom: 10px;
        }

        /* ç§»åŠ¨ç«¯é€‚é… */
        @media (max-width: 768px) {
            .container {
                padding: 20px;
            }

            h1 {
                font-size: 2rem;
            }

            .scratch-demo-area {
                gap: 20px;
            }

            .card-container {
                width: 100%;
                max-width: 300px;
            }

            .button-group {
                flex-direction: column;
                align-items: center;
            }

            button {
                width: 100%;
                max-width: 250px;
            }

            .result-list {
                grid-template-columns: 1fr;
            }
        }

        @keyframes celebrate {
            0% {
                transform: scale(1);
            }

            50% {
                transform: scale(1.05);
            }

            100% {
                transform: scale(1);
            }
        }

        .celebrate {
            animation: celebrate 0.5s ease-in-out 3;
        }
    </style>
</head>
<body>
    <div id="app">
        <div class="container">
            <h1>Vue3 H5 åˆ®åˆ®ä¹æ’ä»¶</h1>
            <p class="subtitle">ç§»åŠ¨ç«¯å’Œæ¡Œé¢ç«¯å‡å¯ä½¿ç”¨çš„åˆ®åˆ®å¡ç»„ä»¶ï¼Œæ”¯æŒè‡ªå®šä¹‰å¥–å“ã€æ¶‚å±‚å’Œäº¤äº’æ•ˆæœ</p>

            <div class="scratch-demo-area">
                <!-- åˆ®åˆ®å¡1ï¼šåŸºæœ¬æ ·å¼ -->
                <div class="card-container">
                    <div class="card-title">ä¸€ç­‰å¥–ï¼šiPhone 15</div>
                    <scratch-card ref="scratch1" :width="280" :height="140" cover-color="#7f8c8d" prize-text="iPhone 15"
                        prize-desc="æœ€æ–°æ¬¾è‹¹æœæ‰‹æœº" :show-percentage="true" @complete="onCardComplete(1)"></scratch-card>
                </div>

                <!-- åˆ®åˆ®å¡2ï¼šè‡ªå®šä¹‰å¥–å“ -->
                <div class="card-container">
                    <div class="card-title">äºŒç­‰å¥–ï¼šä¼˜æƒ åˆ¸ç¤¼åŒ…</div>
                    <scratch-card ref="scratch2" :width="280" :height="140" cover-color="#f39c12" :radius="18"
                        :threshold="65">
                        <template #prize>
                            <div class="custom-prize">
                                <div class="prize-emoji">ğŸ</div>
                                <div class="prize-main">500å…ƒä¼˜æƒ åˆ¸</div>
                                <div class="prize-desc">å…¨åœºé€šç”¨ï¼Œæ— é—¨æ§›</div>
                            </div>
                        </template>
                    </scratch-card>
                </div>

                <!-- åˆ®åˆ®å¡3ï¼šè°¢è°¢å‚ä¸ -->
                <div class="card-container">
                    <div class="card-title">å¹¸è¿å¥–ï¼šè°¢è°¢å‚ä¸</div>
                    <scratch-card ref="scratch3" :width="280" :height="140" cover-color="#3498db" prize-text="è°¢è°¢å‚ä¸"
                        prize-desc="ä¸‹æ¬¡å¥½è¿ï¼" @complete="onCardComplete(3)"></scratch-card>
                </div>
            </div>

            <div class="controls">
                <h2>æ§åˆ¶é¢æ¿</h2>
                <div class="button-group">
                    <button class="btn-reset" @click="resetAllCards">é‡ç½®æ‰€æœ‰åˆ®åˆ®å¡</button>
                    <button class="btn-check" @click="checkAllProgress">æŸ¥çœ‹åˆ®å¼€è¿›åº¦</button>
                    <button class="btn-info" @click="showInstructions = !showInstructions">
                        {{ showInstructions ? 'éšè—è¯´æ˜' : 'æ˜¾ç¤ºè¯´æ˜' }}
                    </button>
                </div>
            </div>

            <div class="result-area">
                <h2>åˆ®å¡ç»“æœ</h2>
                <div class="result-list">
                    <div class="result-item" v-for="(result, index) in cardResults" :key="index">
                        <div class="result-title">{{ result.title }}</div>
                        <div class="result-value">{{ result.value }}</div>
                    </div>
                </div>
            </div>

            <div class="instructions" v-if="showInstructions">
                <h2>ä½¿ç”¨è¯´æ˜</h2>
                <p><strong>æ¡Œé¢ç«¯ï¼š</strong>ä½¿ç”¨é¼ æ ‡åœ¨æ¶‚å±‚ä¸Šæ‹–åŠ¨å³å¯åˆ®å¼€</p>
                <p><strong>ç§»åŠ¨ç«¯ï¼š</strong>ä½¿ç”¨æ‰‹æŒ‡åœ¨æ¶‚å±‚ä¸Šæ»‘åŠ¨å³å¯åˆ®å¼€</p>
                <ul>
                    <li>æ¯å¼ åˆ®åˆ®å¡åˆ®å¼€70%ä»¥ä¸Šè§†ä¸ºå®Œå…¨åˆ®å¼€</li>
                    <li>å®Œå…¨åˆ®å¼€åä¼šæœ‰åº†ç¥åŠ¨ç”»å’Œæç¤º</li>
                    <li>å¯ä»¥è‡ªå®šä¹‰å¥–å“å†…å®¹ã€æ¶‚å±‚é¢œè‰²å’Œåˆ®å¡çµæ•åº¦</li>
                    <li>æ”¯æŒè‡ªå®šä¹‰å¥–å“æ’æ§½ï¼Œå¯ä»¥æ”¾å…¥ä»»æ„HTMLå†…å®¹</li>
                </ul>
            </div>
        </div>

        <div class="footer">
            Vue3 H5 åˆ®åˆ®ä¹æ’ä»¶ - ç›´æ¥å¤åˆ¶æ­¤HTMLæ–‡ä»¶å³å¯ä½¿ç”¨
        </div>
    </div>

    <script>
        const { createApp, ref, onMounted, computed, watch } = Vue;

        // åˆ®åˆ®å¡ç»„ä»¶
        const ScratchCard = {
            template: `
                <div class="scratch-container">
                    <!-- åº•å±‚ï¼šå¥–å“å±•ç¤º -->
                    <div class="prize-content" :style="prizeStyle">
                        <slot name="prize">
                            <div class="default-prize" :class="{ 'celebrate': isComplete }">
                                <div class="prize-main">{{ prizeText }}</div>
                                <div class="prize-desc" v-if="prizeDesc">{{ prizeDesc }}</div>
                            </div>
                        </slot>
                    </div>
                    
                    <!-- é¡¶å±‚ï¼šæ¶‚å±‚ -->
                    <canvas
                        ref="canvasRef"
                        class="scratch-canvas"
                        :width="width"
                        :height="height"
                        @mousedown="handleMouseDown"
                        @mousemove="handleMouseMove"
                        @mouseup="handleMouseUp"
                        @mouseleave="handleMouseUp"
                        @touchstart="handleTouchStart"
                        @touchmove="handleTouchMove"
                        @touchend="handleTouchEnd"
                    ></canvas>
                    
                    <!-- åˆ®å¼€æ¯”ä¾‹æç¤º -->
                    <div v-if="showPercentage" class="percentage">
                        å·²åˆ®å¼€: {{ percentage }}%
                    </div>
                </div>
            `,
            props: {
                // ç”»å¸ƒå®½åº¦
                width: {
                    type: Number,
                    default: 300
                },
                // ç”»å¸ƒé«˜åº¦
                height: {
                    type: Number,
                    default: 150
                },
                // æ¶‚å±‚é¢œè‰²
                coverColor: {
                    type: String,
                    default: '#999'
                },
                // åˆ®å¼€åŠå¾„
                radius: {
                    type: Number,
                    default: 15
                },
                // åˆ®å¼€æ¯”ä¾‹é˜ˆå€¼ï¼ˆè¾¾åˆ°è¯¥æ¯”ä¾‹è§†ä¸ºå…¨éƒ¨åˆ®å¼€ï¼‰
                threshold: {
                    type: Number,
                    default: 70
                },
                // å¥–å“æ–‡å­—
                prizeText: {
                    type: String,
                    default: 'æ­å–œä¸­å¥–ï¼'
                },
                // å¥–å“æè¿°
                prizeDesc: {
                    type: String,
                    default: ''
                },
                // æ˜¯å¦æ˜¾ç¤ºåˆ®å¼€ç™¾åˆ†æ¯”
                showPercentage: {
                    type: Boolean,
                    default: false
                }
            },
            emits: ['scratch-start', 'scratch-end', 'complete'],
            setup(props, { emit }) {
                // Refs
                const canvasRef = ref(null);
                const ctx = ref(null);
                const isDrawing = ref(false);
                const lastPoint = ref({ x: 0, y: 0 });
                const percentage = ref(0);
                const isComplete = ref(false);

                // è®¡ç®—å¥–å“åŒºåŸŸæ ·å¼
                const prizeStyle = computed(() => ({
                    width: `${props.width}px`,
                    height: `${props.height}px`,
                    lineHeight: `${props.height}px`,
                    background: 'linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%)'
                }));

                // åˆå§‹åŒ–ç”»å¸ƒ
                const initCanvas = () => {
                    if (!canvasRef.value) return;

                    const canvas = canvasRef.value;
                    ctx.value = canvas.getContext('2d');

                    // ç»˜åˆ¶æ¶‚å±‚
                    drawCover();
                };

                // ç»˜åˆ¶æ¶‚å±‚
                const drawCover = () => {
                    if (!ctx.value) return;

                    const { width, height, coverColor } = props;

                    // åˆ›å»ºæ¸å˜èƒŒæ™¯
                    const gradient = ctx.value.createLinearGradient(0, 0, width, height);
                    gradient.addColorStop(0, coverColor);
                    gradient.addColorStop(1, adjustColor(coverColor, -20));

                    ctx.value.fillStyle = gradient;
                    ctx.value.fillRect(0, 0, width, height);

                    // æ·»åŠ ä¸€äº›æ–‡å­—æç¤º
                    ctx.value.fillStyle = '#fff';
                    ctx.value.font = 'bold 18px Arial';
                    ctx.value.textAlign = 'center';
                    ctx.value.fillText('åˆ®å¼€æ¶‚å±‚', width / 2, height / 2 - 10);

                    ctx.value.font = '14px Arial';
                    ctx.value.fillText('æŸ¥çœ‹å¥–å“', width / 2, height / 2 + 15);

                    // ç»˜åˆ¶ç½‘æ ¼çº¿
                    ctx.value.strokeStyle = 'rgba(255, 255, 255, 0.3)';
                    ctx.value.lineWidth = 1;

                    // å‚ç›´çº¿
                    for (let x = 0; x < width; x += 20) {
                        ctx.value.beginPath();
                        ctx.value.moveTo(x, 0);
                        ctx.value.lineTo(x, height);
                        ctx.value.stroke();
                    }

                    // æ°´å¹³çº¿
                    for (let y = 0; y < height; y += 20) {
                        ctx.value.beginPath();
                        ctx.value.moveTo(0, y);
                        ctx.value.lineTo(width, y);
                        ctx.value.stroke();
                    }
                };

                // è°ƒæ•´é¢œè‰²äº®åº¦
                const adjustColor = (color, amount) => {
                    // ç®€åŒ–å¤„ç†ï¼Œå®é™…åº”è¯¥è§£æé¢œè‰²å€¼
                    return color;
                };

                // è·å–ç”»å¸ƒä¸Šçš„åæ ‡
                const getCanvasPoint = (clientX, clientY) => {
                    const canvas = canvasRef.value;
                    const rect = canvas.getBoundingClientRect();
                    return {
                        x: clientX - rect.left,
                        y: clientY - rect.top
                    };
                };

                // é¼ æ ‡äº‹ä»¶å¤„ç†
                const handleMouseDown = (e) => {
                    isDrawing.value = true;
                    const point = getCanvasPoint(e.clientX, e.clientY);
                    lastPoint.value = point;
                    emit('scratch-start', point);
                };

                const handleMouseMove = (e) => {
                    if (!isDrawing.value || !ctx.value) return;

                    const point = getCanvasPoint(e.clientX, e.clientY);
                    drawScratch(point);
                    lastPoint.value = point;

                    // è®¡ç®—åˆ®å¼€æ¯”ä¾‹
                    calculatePercentage();
                };

                const handleMouseUp = () => {
                    if (isDrawing.value) {
                        isDrawing.value = false;
                        emit('scratch-end', { percentage: percentage.value });
                    }
                };

                // è§¦æ‘¸äº‹ä»¶å¤„ç†ï¼ˆç§»åŠ¨ç«¯ï¼‰
                const handleTouchStart = (e) => {
                    e.preventDefault();
                    const touch = e.touches[0];
                    isDrawing.value = true;
                    const point = getCanvasPoint(touch.clientX, touch.clientY);
                    lastPoint.value = point;
                    emit('scratch-start', point);
                };

                const handleTouchMove = (e) => {
                    e.preventDefault();
                    if (!isDrawing.value || !ctx.value) return;

                    const touch = e.touches[0];
                    const point = getCanvasPoint(touch.clientX, touch.clientY);
                    drawScratch(point);
                    lastPoint.value = point;

                    calculatePercentage();
                };

                const handleTouchEnd = () => {
                    if (isDrawing.value) {
                        isDrawing.value = false;
                        emit('scratch-end', { percentage: percentage.value });
                    }
                };

                // ç»˜åˆ¶åˆ®å¼€æ•ˆæœ
                const drawScratch = (point) => {
                    // ä½¿ç”¨ destination-out æ¨¡å¼æ“¦é™¤
                    ctx.value.globalCompositeOperation = 'destination-out';
                    ctx.value.beginPath();
                    ctx.value.arc(point.x, point.y, props.radius, 0, Math.PI * 2);
                    ctx.value.fill();

                    // æ¢å¤é»˜è®¤åˆæˆæ¨¡å¼
                    ctx.value.globalCompositeOperation = 'source-over';
                };

                // è®¡ç®—åˆ®å¼€æ¯”ä¾‹
                const calculatePercentage = () => {
                    if (!canvasRef.value || !ctx.value) return;

                    const canvas = canvasRef.value;
                    const imageData = ctx.value.getImageData(0, 0, props.width, props.height);
                    const pixels = imageData.data;
                    let transparentCount = 0;

                    // è®¡ç®—é€æ˜åƒç´ æ•°é‡
                    for (let i = 3; i < pixels.length; i += 4) {
                        if (pixels[i] === 0) {
                            transparentCount++;
                        }
                    }

                    const totalPixels = props.width * props.height;
                    const newPercentage = Math.round((transparentCount / totalPixels) * 100);

                    if (newPercentage !== percentage.value) {
                        percentage.value = newPercentage;

                        // è¾¾åˆ°é˜ˆå€¼ï¼Œè§¦å‘å®Œæˆäº‹ä»¶
                        if (newPercentage >= props.threshold && !isComplete.value) {
                            isComplete.value = true;
                            emit('complete', { percentage: newPercentage });

                            // è‡ªåŠ¨æ¸…é™¤å‰©ä½™æ¶‚å±‚
                            setTimeout(() => {
                                ctx.value.clearRect(0, 0, props.width, props.height);
                                percentage.value = 100;
                            }, 500);
                        }
                    }
                };

                // é‡ç½®åˆ®åˆ®ä¹
                const resetScratch = () => {
                    percentage.value = 0;
                    isComplete.value = false;
                    drawCover();
                };

                // è·å–åˆ®å¼€æ¯”ä¾‹
                const getPercentage = () => percentage.value;

                // ç”Ÿå‘½å‘¨æœŸ
                onMounted(() => {
                    initCanvas();
                });

                // æš´éœ²æ–¹æ³•ç»™çˆ¶ç»„ä»¶
                return {
                    canvasRef,
                    ctx,
                    isDrawing,
                    lastPoint,
                    percentage,
                    isComplete,
                    prizeStyle,
                    initCanvas,
                    drawCover,
                    getCanvasPoint,
                    handleMouseDown,
                    handleMouseMove,
                    handleMouseUp,
                    handleTouchStart,
                    handleTouchMove,
                    handleTouchEnd,
                    drawScratch,
                    calculatePercentage,
                    resetScratch,
                    getPercentage
                };
            }
        };

        // åˆ›å»ºVueåº”ç”¨
        const app = createApp({
            components: {
                'scratch-card': ScratchCard
            },
            setup() {
                // ç»„ä»¶å¼•ç”¨
                const scratch1 = ref(null);
                const scratch2 = ref(null);
                const scratch3 = ref(null);

                // çŠ¶æ€
                const showInstructions = ref(true);
                const cardResults = ref([
                    { title: 'åˆ®åˆ®å¡1: iPhone 15', value: 'ç­‰å¾…åˆ®å¼€' },
                    { title: 'åˆ®åˆ®å¡2: ä¼˜æƒ åˆ¸ç¤¼åŒ…', value: 'ç­‰å¾…åˆ®å¼€' },
                    { title: 'åˆ®åˆ®å¡3: è°¢è°¢å‚ä¸', value: 'ç­‰å¾…åˆ®å¼€' }
                ]);

                // åˆ®åˆ®å¡å®Œæˆå›è°ƒ
                const onCardComplete = (cardNumber) => {
                    const prizeNames = ['iPhone 15', 'ä¼˜æƒ åˆ¸ç¤¼åŒ…', 'è°¢è°¢å‚ä¸'];
                    const resultIndex = cardNumber - 1;

                    cardResults.value[resultIndex].value = 'å·²åˆ®å¼€100% - æ­å–œï¼';

                    // æ˜¾ç¤ºåº†ç¥æ¶ˆæ¯
                    setTimeout(() => {
                        alert(`æ­å–œï¼æ‚¨å·²å®Œå…¨åˆ®å¼€åˆ®åˆ®å¡${cardNumber} (${prizeNames[resultIndex]})`);
                    }, 300);
                };

                // é‡ç½®æ‰€æœ‰åˆ®åˆ®å¡
                const resetAllCards = () => {
                    [scratch1, scratch2, scratch3].forEach(ref => {
                        if (ref.value && ref.value.resetScratch) {
                            ref.value.resetScratch();
                        }
                    });

                    // é‡ç½®ç»“æœæ˜¾ç¤º
                    cardResults.value = [
                        { title: 'åˆ®åˆ®å¡1: iPhone 15', value: 'ç­‰å¾…åˆ®å¼€' },
                        { title: 'åˆ®åˆ®å¡2: ä¼˜æƒ åˆ¸ç¤¼åŒ…', value: 'ç­‰å¾…åˆ®å¼€' },
                        { title: 'åˆ®åˆ®å¡3: è°¢è°¢å‚ä¸', value: 'ç­‰å¾…åˆ®å¼€' }
                    ];

                    alert('æ‰€æœ‰åˆ®åˆ®å¡å·²é‡ç½®ï¼');
                };

                // æŸ¥çœ‹æ‰€æœ‰åˆ®åˆ®å¡è¿›åº¦
                const checkAllProgress = () => {
                    const cards = [scratch1, scratch2, scratch3];
                    const prizeNames = ['iPhone 15', 'ä¼˜æƒ åˆ¸ç¤¼åŒ…', 'è°¢è°¢å‚ä¸'];

                    let message = 'åˆ®åˆ®å¡è¿›åº¦:\n';

                    cards.forEach((ref, index) => {
                        if (ref.value && ref.value.getPercentage) {
                            const percent = ref.value.getPercentage();
                            message += `${index + 1}. ${prizeNames[index]}: ${percent}%\n`;

                            // æ›´æ–°ç»“æœæ˜¾ç¤º
                            if (percent === 0) {
                                cardResults.value[index].value = 'ç­‰å¾…åˆ®å¼€';
                            } else if (percent < 70) {
                                cardResults.value[index].value = `å·²åˆ®å¼€${percent}%`;
                            } else {
                                cardResults.value[index].value = `å·²åˆ®å¼€${percent}% - å®Œæˆ`;
                            }
                        }
                    });

                    alert(message);
                };

                return {
                    scratch1,
                    scratch2,
                    scratch3,
                    showInstructions,
                    cardResults,
                    onCardComplete,
                    resetAllCards,
                    checkAllProgress
                };
            }
        });

        // æŒ‚è½½åº”ç”¨
        app.mount('#app');
    </script>
</body>
</html>
